<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Cocon Familial (v4)</title>
    
    <style>
        /* Variables de couleur pour le mode clair et sombre */
        :root {
            --bg-color: #f7f3e9;
            --text-color: #333;
            --card-bg: #fff;
            --primary-color: #ff6f61;
            --secondary-color: #6a0572;
            --border-color: #ddd;
            --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        body.dark-mode {
            --bg-color: #2c3e50;
            --text-color: #ecf0f1;
            --card-bg: #34495e;
            --primary-color: #e74c3c;
            --secondary-color: #8e44ad;
            --border-color: #555;
        }
        
        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 2rem 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
            opacity: 0;
            animation: fadeInBody 1s forwards;
        }

        @keyframes fadeInBody {
            to { opacity: 1; }
        }

        /* En-t√™te et pied de page */
        header, footer {
            width: 100%;
            max-width: 1200px;
            text-align: center;
            padding: 1rem 0;
        }

        header h1 {
            font-size: clamp(2rem, 5vw, 3rem);
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            animation: pulseHeader 2s infinite alternate;
        }
        @keyframes pulseHeader {
            from { transform: scale(1); }
            to { transform: scale(1.02); }
        }

        /* Conteneurs principaux */
        main {
            width: 100%;
            max-width: 1200px;
            display: grid;
            gap: 2rem;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            padding: 2rem 0;
        }

        /* Styles des cartes (sections) */
        .card {
            background-color: var(--card-bg);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInCard 1s ease-out forwards;
        }
        @keyframes fadeInCard {
            to { opacity: 1; transform: translateY(0); }
        }

        /* Boutons et formulaires */
        .button {
            display: inline-block;
            padding: 12px 24px;
            background-color: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.2s;
            text-align: center;
            border: none;
            cursor: pointer;
            margin-top: 1rem;
        }

        .button:hover {
            background-color: #e74c3c;
            transform: scale(1.05);
        }

        /* Styles des sections sp√©cifiques */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        .image-gallery img {
            width: 100%;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .quiz-container .option {
            display: block;
            padding: 12px;
            background-color: var(--border-color);
            border-radius: 50px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
            text-align: center;
            margin-bottom: 0.5rem;
        }
        .quiz-container .option.correct {
            background-color: #27ae60;
            color: white;
        }
        .quiz-container .option.wrong {
            background-color: #e74c3c;
            color: white;
        }

        /* Modal pour l'agrandissement d'image */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .modal-content {
            max-width: 90%;
            max-height: 90%;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
            transition: transform 0.3s;
            transform: scale(0.8);
        }

        /* Bouton de th√®me */
        #theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: transparent;
            border: none;
            font-size: 2.5rem;
            cursor: pointer;
            z-index: 1000;
            transition: transform 0.2s ease-in-out, color 0.5s;
            color: var(--text-color);
        }
        
        .blog-post, .memory-item {
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }
        .blog-post:last-child, .memory-item:last-child {
            border-bottom: none;
        }
        .blog-post h3, .memory-item h3 {
            margin-bottom: 0.5rem;
        }
        .blog-post .meta, .memory-item .meta {
            font-size: 0.9rem;
            color: #999;
        }
    </style>
</head>
<body>
    <button id="theme-toggle" aria-label="Bascule mode sombre/clair">üåô</button>

    <header>
        <h1 id="welcome-message">Bienvenue !</h1>
        <p>Un lieu pour partager nos histoires et nos souvenirs les plus pr√©cieux.</p>
    </header>

    <main id="app-container">
        </main>
    
    <footer>
        <p>¬© 2024 Notre Famille. Tous droits r√©serv√©s.</p>
    </footer>

    <script>
        /**
         * Couche 1 : LES DONN√âES DE L'APPLICATION
         * Toutes les donn√©es du site sont stock√©es ici pour une gestion facile.
         */
        const APP_DATA = {
            images: [
                { src: 'https://images.unsplash.com/photo-1542042168-5e263a2a677e?q=80&w=1470&auto=format&fit=crop', alt: 'Famille souriant sur une plage' },
                { src: 'https://images.unsplash.com/photo-1628151241187-73d28d052d92?q=80&w=1470&auto=format&fit=crop', alt: 'Famille en vacances' },
                { src: 'https://images.unsplash.com/photo-1544458514-633b49c717be?q=80&w=1470&auto=format&fit=crop', alt: 'Repas de famille' },
                { src: 'https://images.unsplash.com/photo-1517404215738-15263e9f9850?q=80&w=1470&auto=format&fit=crop', alt: 'Pique-nique en famille' },
                { src: 'https://images.unsplash.com/photo-1513589255018-b2a63274641c?q=80&w=1470&auto=format&fit=crop', alt: 'No√´l en famille' },
                { src: 'https://images.unsplash.com/photo-1582239474944-ec85317796d1?q=80&w=1470&auto=format&fit=crop', alt: 'Anniversaire' },
            ],
            recipes: [
                { title: "Lasagnes √† la bolognaise", author: "Maman", description: "Un classique ind√©modable.", prepTime: "1h30" },
                { title: "G√¢teau au chocolat fondant", author: "Papa", description: "Un dessert irr√©sistible.", prepTime: "45min" },
                { title: "Gratin dauphinois", author: "Grand-M√®re", description: "Une recette traditionnelle.", prepTime: "1h" },
            ],
            quizQuestions: [
                { question: "Quel est notre plat pr√©f√©r√© ?", options: ["Lasagnes", "Pizza", "Riz Cantonais", "P√¢tes au pesto"], answer: "Lasagnes" },
                { question: "Quelle est notre destination de vacances pr√©f√©r√©e ?", options: ["La mer", "La montagne", "La campagne", "La ville"], answer: "La montagne" },
                { question: "Quel est le pr√©nom du plus jeune membre de la famille ?", options: ["L√©a", "Thomas", "Sophie", "Lucas"], answer: "Lucas" },
            ],
            history: {
                title: "De nos origines √† nos traditions",
                paragraphs: [
                    "L'histoire de notre famille commence il y a plusieurs g√©n√©rations, dans un petit village au c≈ìur des montagnes.",
                    "Au fil du temps, notre famille s'est agrandie et dispers√©e. Pourtant, nous avons toujours gard√© un lien fort.",
                    "Aujourd'hui, nous sommes une famille moderne, connect√©e, mais nous n'oublions jamais d'o√π nous venons. Ce site web est notre mani√®re de pr√©server notre histoire, de la partager et de c√©l√©brer l'amour qui nous unit."
                ]
            },
            blogPosts: [
                { title: "Un week-end inoubliable", date: "24/10/2024", content: "Nous avons pass√© un week-end magnifique √† la campagne, loin du tumulte de la ville. Le soleil √©tait au rendez-vous et nous avons pu faire de longues balades en for√™t." },
                { title: "Premiers pas de L√©a", date: "12/09/2024", content: "Quelle joie ! Notre petite L√©a a fait ses tout premiers pas. Un moment rempli d'√©motion que nous n'oublierons jamais." }
            ],
            memories: [
                { date: "15/07/2023", event: "Mariage de Thomas et Sophie", description: "Un jour magique, rempli de rires et d'amour. On s'est tous retrouv√©s pour c√©l√©brer cette union." },
                { date: "03/01/2022", event: "Voyage en Italie", description: "Notre grand voyage en famille. Les pizzas, les glaces, les monuments... des souvenirs grav√©s dans nos m√©moires." }
            ]
        };

        /**
         * Couche 2 : GESTION DE L'INTERFACE UTILISATEUR (UI)
         * Fonctions pour cr√©er les √©l√©ments HTML et les afficher.
         */
        const UI = {
            createElement: (tag, attributes = {}, ...children) => {
                const element = document.createElement(tag);
                for (const key in attributes) {
                    element.setAttribute(key, attributes[key]);
                }
                children.forEach(child => {
                    if (typeof child === 'string') {
                        element.appendChild(document.createTextNode(child));
                    } else {
                        element.appendChild(child);
                    }
                });
                return element;
            },

            createCard: (id, title, description, contentGenerator) => {
                const card = UI.createElement('section', { class: 'card', id: `${id}-card` });
                const heading = UI.createElement('h2', {}, title);
                const desc = UI.createElement('p', {}, description);
                card.appendChild(heading);
                card.appendChild(desc);
                if (contentGenerator) {
                    contentGenerator(card);
                }
                return card;
            },

            renderGallery: (parent) => {
                const gallery = UI.createElement('div', { class: 'image-gallery' });
                APP_DATA.images.forEach(image => {
                    const img = UI.createElement('img', { src: image.src, alt: image.alt });
                    gallery.appendChild(img);
                });
                parent.appendChild(gallery);
                return gallery;
            },

            renderRecipes: (parent) => {
                const list = UI.createElement('div');
                APP_DATA.recipes.forEach(recipe => {
                    const item = UI.createElement('div', { class: 'recipe-item' });
                    item.innerHTML = `
                        <h3>${recipe.title}</h3>
                        <p><strong>Par :</strong> ${recipe.author}</p>
                        <p>${recipe.description}</p>
                        <p><small>Pr√©paration : ${recipe.prepTime}</small></p>
                        <hr>
                    `;
                    list.appendChild(item);
                });
                parent.appendChild(list);
            },

            renderContactForm: (parent) => {
                const form = UI.createElement('form', { class: 'contact-form' });
                form.innerHTML = `
                    <label for="name">Votre nom :</label>
                    <input type="text" id="name" required>
                    <label for="email">Votre email :</label>
                    <input type="email" id="email" required>
                    <label for="message">Votre message :</label>
                    <textarea id="message" rows="5" required></textarea>
                `;
                const button = UI.createElement('button', { type: 'submit', class: 'button' }, 'Envoyer');
                form.appendChild(button);
                parent.appendChild(form);
                return form;
            },

            renderQuiz: (parent) => {
                const container = UI.createElement('div', { class: 'quiz-container' });
                const questionDiv = UI.createElement('div', { id: 'quiz-questions' });
                const resultDiv = UI.createElement('div', { id: 'quiz-result', class: 'result' });
                const button = UI.createElement('button', { class: 'button', id: 'quiz-button' }, 'Lancer le quiz !');
                container.appendChild(questionDiv);
                container.appendChild(resultDiv);
                container.appendChild(button);
                parent.appendChild(container);
                return { container, questionDiv, resultDiv, button };
            },

            renderHistory: (parent) => {
                const historyDiv = UI.createElement('div');
                const title = UI.createElement('h3', {}, APP_DATA.history.title);
                historyDiv.appendChild(title);
                APP_DATA.history.paragraphs.forEach(pText => {
                    const p = UI.createElement('p', {}, pText);
                    historyDiv.appendChild(p);
                });
                parent.appendChild(historyDiv);
            },

            renderBlog: (parent) => {
                const blogContainer = UI.createElement('div');
                APP_DATA.blogPosts.forEach(post => {
                    const postDiv = UI.createElement('div', { class: 'blog-post' });
                    const title = UI.createElement('h3', {}, post.title);
                    const meta = UI.createElement('p', { class: 'meta' }, `Publi√© le ${post.date}`);
                    const content = UI.createElement('p', {}, post.content);
                    postDiv.appendChild(title);
                    postDiv.appendChild(meta);
                    postDiv.appendChild(content);
                    blogContainer.appendChild(postDiv);
                });
                parent.appendChild(blogContainer);
            },

            renderMemories: (parent) => {
                const memoriesContainer = UI.createElement('div');
                APP_DATA.memories.forEach(memory => {
                    const memoryDiv = UI.createElement('div', { class: 'memory-item' });
                    const eventTitle = UI.createElement('h3', {}, memory.event);
                    const date = UI.createElement('p', { class: 'meta' }, `Date : ${memory.date}`);
                    const description = UI.createElement('p', {}, memory.description);
                    memoryDiv.appendChild(eventTitle);
                    memoryDiv.appendChild(date);
                    memoryDiv.appendChild(description);
                    memoriesContainer.appendChild(memoryDiv);
                });
                parent.appendChild(memoriesContainer);
            }
        };

        /**
         * Couche 3 : LA LOGIQUE DE L'APPLICATION
         * G√®re les √©v√©nements, l'√©tat et l'initialisation de la page.
         */
        const App = {
            state: {
                theme: localStorage.getItem('theme') || 'light',
                userName: localStorage.getItem('userName') || null,
                quiz: { active: false, score: 0 }
            },
            elements: {
                themeToggle: document.getElementById('theme-toggle'),
                welcomeMessage: document.getElementById('welcome-message'),
                appContainer: document.getElementById('app-container'),
            },

            init: () => {
                App.renderAllSections();
                App.setupEventListeners();
                App.applyInitialTheme();
                App.personalizeWelcome();
            },

            renderAllSections: () => {
                const appContainer = App.elements.appContainer;
                appContainer.appendChild(UI.createCard('gallery', 'Nos moments pr√©f√©r√©s', 'Cliquez sur les photos pour les agrandir et les explorer.', UI.renderGallery));
                appContainer.appendChild(UI.createCard('recipes', 'Les recettes de maman', 'D√©couvrez notre collection de recettes qui r√©chauffent le c≈ìur.', UI.renderRecipes));
                appContainer.appendChild(UI.createCard('contact', 'Laissez-nous un message', 'Nous adorons recevoir de vos nouvelles !', UI.renderContactForm));
                appContainer.appendChild(UI.createCard('quiz', 'Petit quiz familial', 'Testez vos connaissances sur la famille !', UI.renderQuiz));
                appContainer.appendChild(UI.createCard('history', 'L\'histoire de notre famille', 'De nos origines √† nos traditions les plus ch√®res, explorez notre histoire.', UI.renderHistory));
                appContainer.appendChild(UI.createCard('blog', 'Blog familial', 'Les derni√®res nouvelles et anecdotes de la famille.', UI.renderBlog));
                appContainer.appendChild(UI.createCard('memories', 'Album de souvenirs', 'Les moments qui ont marqu√© notre histoire.', UI.renderMemories));
            },

            setupEventListeners: () => {
                App.elements.themeToggle.addEventListener('click', App.toggleTheme);
                const galleryElement = document.getElementById('gallery-card').querySelector('.image-gallery');
                galleryElement.addEventListener('click', App.handleImageClick);
                const contactForm = document.getElementById('contact-card').querySelector('.contact-form');
                contactForm.addEventListener('submit', App.handleContactSubmit);
                const quizContainer = document.getElementById('quiz-card').querySelector('.quiz-container');
                const quizButton = quizContainer.querySelector('#quiz-button');
                quizButton.addEventListener('click', () => App.toggleQuiz(quizContainer));
            },

            applyInitialTheme: () => {
                if (App.state.theme === 'dark') {
                    document.body.classList.add('dark-mode');
                    App.elements.themeToggle.textContent = '‚òÄÔ∏è';
                }
            },
            toggleTheme: () => {
                document.body.classList.toggle('dark-mode');
                const isDarkMode = document.body.classList.contains('dark-mode');
                App.state.theme = isDarkMode ? 'dark' : 'light';
                localStorage.setItem('theme', App.state.theme);
                App.elements.themeToggle.textContent = isDarkMode ? '‚òÄÔ∏è' : 'üåô';
            },
            personalizeWelcome: () => {
                if (App.state.userName) {
                    App.elements.welcomeMessage.textContent = `Bienvenue, ${App.state.userName} !`;
                } else {
                    setTimeout(() => {
                        const newName = prompt('Bienvenue ! Quel est votre pr√©nom ?');
                        if (newName && newName.trim() !== '') {
                            App.state.userName = newName.trim();
                            localStorage.setItem('userName', App.state.userName);
                            App.elements.welcomeMessage.textContent = `Bienvenue, ${App.state.userName} !`;
                        }
                    }, 1000);
                }
            },
            handleImageClick: (event) => {
                if (event.target.tagName === 'IMG') {
                    const modal = UI.createElement('div', { class: 'modal' });
                    const modalImg = UI.createElement('img', { class: 'modal-content', src: event.target.src, alt: event.target.alt });
                    modal.appendChild(modalImg);
                    document.body.appendChild(modal);

                    setTimeout(() => {
                        modal.style.opacity = '1';
                        modalImg.style.transform = 'scale(1)';
                    }, 50);
                    modal.addEventListener('click', () => {
                        modal.style.opacity = '0';
                        modalImg.style.transform = 'scale(0.8)';
                        setTimeout(() => document.body.removeChild(modal), 300);
                    });
                }
            },
            handleContactSubmit: (event) => {
                event.preventDefault();
                alert('Merci pour votre message ! Nous vous r√©pondrons bient√¥t.');
                event.target.reset();
            },
            toggleQuiz: (quizContainer) => {
                const quizQuestionsDiv = quizContainer.querySelector('#quiz-questions');
                const quizResultDiv = quizContainer.querySelector('#quiz-result');
                const quizButton = quizContainer.querySelector('#quiz-button');
                
                if (App.state.quiz.active) {
                    quizQuestionsDiv.innerHTML = '';
                    quizResultDiv.textContent = '';
                    App.state.quiz.active = false;
                    quizButton.textContent = "Lancer le quiz !";
                } else {
                    App.state.quiz.active = true;
                    App.state.quiz.score = 0;
                    quizResultDiv.textContent = '';
                    APP_DATA.quizQuestions.forEach((q, index) => {
                        const questionItem = UI.createElement('div', { class: 'question-item' });
                        questionItem.innerHTML = `<h3>${index + 1}. ${q.question}</h3>`;
                        q.options.forEach(option => {
                            const optionElement = UI.createElement('div', { class: 'option' }, option);
                            optionElement.addEventListener('click', () => App.checkQuizAnswer(option, q.answer, optionElement, quizResultDiv));
                            questionItem.appendChild(optionElement);
                        });
                        quizQuestionsDiv.appendChild(questionItem);
                    });
                    quizButton.textContent = "Recommencer le quiz";
                }
            },
            checkQuizAnswer: (selectedOption, correctAnswer, element, quizResultDiv) => {
                if (!App.state.quiz.active) return;
                const questionItem = element.parentElement;
                questionItem.querySelectorAll('.option').forEach(opt => {
                    opt.style.pointerEvents = 'none';
                    if (opt.textContent === correctAnswer) {
                        opt.classList.add('correct');
                    }
                });

                if (selectedOption === correctAnswer) {
                    App.state.quiz.score++;
                    element.classList.add('correct');
                } else {
                    element.classList.add('wrong');
                }
                const allAnswered = Array.from(document.querySelectorAll('.quiz-container .question-item')).every(item => item.querySelector('.correct, .wrong'));
                if (allAnswered) {
                    App.displayFinalQuizResult(quizResultDiv);
                }
            },
            displayFinalQuizResult: (quizResultDiv) => {
                const scorePercentage = (App.state.quiz.score / APP_DATA.quizQuestions.length) * 100;
                let message = `Votre score : ${App.state.quiz.score} / ${APP_DATA.quizQuestions.length}. `;
                if (scorePercentage >= 80) {
                    message += "Fantastique, vous √™tes un vrai membre de la famille ! üíñ";
                    quizResultDiv.classList.add('correct');
                } else {
                    message += "Oups, il y a encore beaucoup de choses √† apprendre ! üòâ";
                    quizResultDiv.classList.add('wrong');
                }
                quizResultDiv.textContent = message;
                App.state.quiz.active = false;
            }
        };

        // Lancement de l'application
        document.addEventListener('DOMContentLoaded', App.init);
    </script>
</body>
</html>
