<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Cocon Familial (Pro)</title>
    
    <style>
        /* Variables de couleur et de thÃ¨me */
        :root {
            --bg-color: #f0f4f8;
            --text-color: #334e68;
            --card-bg: #ffffff;
            --primary-color: #3f51b5; /* Bleu indÃ©modable */
            --secondary-color: #ff4081; /* Rose Ã©clatant */
            --border-color: #e3e8ee;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition-speed: 0.3s;
            --font-family: 'Poppins', sans-serif;
        }

        body.dark-mode {
            --bg-color: #2c3e50;
            --text-color: #ecf0f1;
            --card-bg: #34495e;
            --primary-color: #64b5f6;
            --secondary-color: #f06292;
            --border-color: #55606d;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        /* Styles de base et mise en page */
        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 2rem 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
            transition: background-color var(--transition-speed), color var(--transition-speed);
        }

        /* Effet de parallaxe sur le body */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(var(--primary-rgb), 0.1) 0%, transparent 70%),
                        radial-gradient(circle, rgba(var(--secondary-rgb), 0.1) 0%, transparent 70%);
            background-size: 800px 800px, 600px 600px;
            background-position: top left, bottom right;
            animation: moveGradient 20s linear infinite;
            z-index: -1;
            opacity: 0.5;
        }
        @keyframes moveGradient {
            0% { background-position: top left, bottom right; }
            100% { background-position: top right, bottom left; }
        }
        body.dark-mode::before {
            filter: invert(1);
        }

        /* Conteneurs et mise en page */
        header, footer {
            width: 100%;
            max-width: 1200px;
            text-align: center;
            padding: 1.5rem 0;
            transition: transform 0.3s ease;
        }
        header { transform: translateY(-50px) scale(0.9); opacity: 0; animation: header-in 1s forwards; }
        footer { transform: translateY(50px) scale(0.9); opacity: 0; animation: footer-in 1s forwards; animation-delay: 1s; }
        @keyframes header-in { to { transform: translateY(0) scale(1); opacity: 1; } }
        @keyframes footer-in { to { transform: translateY(0) scale(1); opacity: 1; } }

        header h1 {
            font-size: clamp(2rem, 5vw, 3rem);
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            opacity: 0;
            transition: opacity 0.5s;
        }

        main {
            width: 100%;
            max-width: 1200px;
            display: grid;
            gap: 2rem;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            padding: 2rem 0;
        }

        /* Composants de l'interface utilisateur */
        .card {
            background-color: var(--card-bg);
            padding: 2rem;
            border-radius: 16px;
            box-shadow: var(--box-shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            opacity: 0;
            transform: translateY(20px);
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .button {
            display: inline-block;
            padding: 12px 28px;
            background-color: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            transition: background-color var(--transition-speed), transform 0.2s ease, box-shadow var(--transition-speed);
            text-align: center;
            border: none;
            cursor: pointer;
            margin-top: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .button:hover {
            background-color: var(--secondary-color);
            transform: scale(1.02);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2);
        }
        .button:active {
            transform: scale(0.98);
        }
        
        /* Styles spÃ©cifiques des sections */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }
        .image-gallery img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .image-gallery img:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        /* Effet de 'nappe' sur les images */
        .image-gallery img::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        .image-gallery img:hover::after {
            opacity: 1;
        }

        /* Modal et pop-ups */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.4s ease;
            backdrop-filter: blur(5px);
        }
        .modal.open { opacity: 1; }
        .modal-content {
            max-width: 90%;
            max-height: 90%;
            border-radius: 16px;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.5);
            transform: scale(0.7);
            transition: transform 0.4s ease;
        }
        .modal.open .modal-content { transform: scale(1); }

        /* Notifications (toasts) */
        #notification-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 3000;
            display: flex;
            flex-direction: column-reverse;
            gap: 10px;
        }
        .notification {
            background-color: #333;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .notification.show { opacity: 1; transform: translateY(0); }
    </style>
</head>
<body>
    <button id="theme-toggle" aria-label="Bascule mode sombre/clair" style="position: fixed; top: 20px; right: 20px; background: none; border: none; font-size: 2.5rem; cursor: pointer; color: var(--text-color); transition: color 0.3s ease;">ðŸŒ™</button>

    <header>
        <h1 id="welcome-message"></h1>
        <p>Un lieu pour partager nos histoires et nos souvenirs les plus prÃ©cieux.</p>
    </header>

    <main id="app-container">
        </main>
    
    <footer>
        <p>Â© 2024 Notre Famille. Tous droits rÃ©servÃ©s.</p>
    </footer>

    <div id="notification-container"></div>

    <script>
        /**
         * Couche 1 : LES DONNÃ‰ES DE L'APPLICATION
         * Toutes les donnÃ©es du site sont stockÃ©es ici pour une gestion facile.
         */
        const APP_DATA = {
            images: [
                { src: 'https://images.unsplash.com/photo-1542042168-5e263a2a677e?q=80&w=1470&auto=format&fit=crop', alt: 'Famille souriant sur une plage' },
                { src: 'https://images.unsplash.com/photo-1628151241187-73d28d052d92?q=80&w=1470&auto=format&fit=crop', alt: 'Famille en vacances' },
                { src: 'https://images.unsplash.com/photo-1544458514-633b49c717be?q=80&w=1470&auto=format&fit=crop', alt: 'Repas de famille' },
                { src: 'https://images.unsplash.com/photo-1517404215738-15263e9f9850?q=80&w=1470&auto=format&fit=crop', alt: 'Pique-nique en famille' },
                { src: 'https://images.unsplash.com/photo-1513589255018-b2a63274641c?q=80&w=1470&auto=format&fit=crop', alt: 'NoÃ«l en famille' },
                { src: 'https://images.unsplash.com/photo-1582239474944-ec85317796d1?q=80&w=1470&auto=format&fit=crop', alt: 'Anniversaire' },
            ],
            recipes: [
                { title: "Lasagnes Ã  la bolognaise", author: "Maman", description: "Un classique indÃ©modable.", prepTime: "1h30" },
                { title: "GÃ¢teau au chocolat fondant", author: "Papa", description: "Un dessert irrÃ©sistible.", prepTime: "45min" },
                { title: "Gratin dauphinois", author: "Grand-MÃ¨re", description: "Une recette traditionnelle.", prepTime: "1h" },
            ],
            quizQuestions: [
                { question: "Quel est notre plat prÃ©fÃ©rÃ© ?", options: ["Lasagnes", "Pizza", "Riz Cantonais", "PÃ¢tes au pesto"], answer: "Lasagnes" },
                { question: "Quelle est notre destination de vacances prÃ©fÃ©rÃ©e ?", options: ["La mer", "La montagne", "La campagne", "La ville"], answer: "La montagne" },
                { question: "Quel est le prÃ©nom du plus jeune membre de la famille ?", options: ["LÃ©a", "Thomas", "Sophie", "Lucas"], answer: "Lucas" },
            ],
            history: {
                title: "De nos origines Ã  nos traditions",
                paragraphs: [
                    "L'histoire de notre famille commence il y a plusieurs gÃ©nÃ©rations, dans un petit village au cÅ“ur des montagnes.",
                    "Au fil du temps, notre famille s'est agrandie et dispersÃ©e. Pourtant, nous avons toujours gardÃ© un lien fort.",
                    "Aujourd'hui, nous sommes une famille moderne, connectÃ©e, mais nous n'oublions jamais d'oÃ¹ nous venons. Ce site web est notre maniÃ¨re de prÃ©server notre histoire, de la partager et de cÃ©lÃ©brer l'amour qui nous unit."
                ]
            },
            blogPosts: [
                { title: "Un week-end inoubliable", date: "24/10/2024", content: "Nous avons passÃ© un week-end magnifique Ã  la campagne, loin du tumulte de la ville. Le soleil Ã©tait au rendez-vous et nous avons pu faire de longues balades en forÃªt." },
                { title: "Premiers pas de LÃ©a", date: "12/09/2024", content: "Quelle joie ! Notre petite LÃ©a a fait ses tout premiers pas. Un moment rempli d'Ã©motion que nous n'oublierons jamais." }
            ],
            memories: [
                { date: "15/07/2023", event: "Mariage de Thomas et Sophie", description: "Un jour magique, rempli de rires et d'amour. On s'est tous retrouvÃ©s pour cÃ©lÃ©brer cette union." },
                { date: "03/01/2022", event: "Voyage en Italie", description: "Notre grand voyage en famille. Les pizzas, les glaces, les monuments... des souvenirs gravÃ©s dans nos mÃ©moires." }
            ]
        };

        /**
         * Couche 2 : GESTION DE L'INTERFACE UTILISATEUR (UI)
         * Fonctions pour crÃ©er les Ã©lÃ©ments HTML et les afficher.
         */
        const UI = {
            createElement: (tag, attributes = {}, ...children) => {
                const element = document.createElement(tag);
                for (const key in attributes) {
                    element.setAttribute(key, attributes[key]);
                }
                children.forEach(child => {
                    if (typeof child === 'string') {
                        element.appendChild(document.createTextNode(child));
                    } else {
                        element.appendChild(child);
                    }
                });
                return element;
            },

            createCard: (id, title, description, contentGenerator) => {
                const card = UI.createElement('section', { class: 'card', id: `${id}-card` });
                const heading = UI.createElement('h2', {}, title);
                const desc = UI.createElement('p', {}, description);
                card.appendChild(heading);
                card.appendChild(desc);
                if (contentGenerator) {
                    contentGenerator(card);
                }
                return card;
            },

            renderGallery: (parent) => {
                const gallery = UI.createElement('div', { class: 'image-gallery' });
                APP_DATA.images.forEach(image => {
                    const img = UI.createElement('img', { src: image.src, alt: image.alt });
                    gallery.appendChild(img);
                });
                parent.appendChild(gallery);
                return gallery;
            },

            renderRecipes: (parent) => {
                const list = UI.createElement('div');
                APP_DATA.recipes.forEach(recipe => {
                    const item = UI.createElement('div', { class: 'recipe-item' });
                    item.innerHTML = `
                        <h3>${recipe.title}</h3>
                        <p><strong>Par :</strong> ${recipe.author}</p>
                        <p>${recipe.description}</p>
                        <p><small>PrÃ©paration : ${recipe.prepTime}</small></p>
                        <hr>
                    `;
                    list.appendChild(item);
                });
                parent.appendChild(list);
            },

            renderContactForm: (parent) => {
                const form = UI.createElement('form', { class: 'contact-form' });
                form.innerHTML = `
                    <label for="name">Votre nom :</label>
                    <input type="text" id="name" required>
                    <label for="email">Votre email :</label>
                    <input type="email" id="email" required>
                    <label for="message">Votre message :</label>
                    <textarea id="message" rows="5" required></textarea>
                `;
                const button = UI.createElement('button', { type: 'submit', class: 'button' }, 'Envoyer');
                form.appendChild(button);
                parent.appendChild(form);
                return form;
            },

            renderQuiz: (parent) => {
                const container = UI.createElement('div', { class: 'quiz-container' });
                const questionDiv = UI.createElement('div', { id: 'quiz-questions' });
                const resultDiv = UI.createElement('div', { id: 'quiz-result', class: 'result' });
                const button = UI.createElement('button', { class: 'button', id: 'quiz-button' }, 'Lancer le quiz !');
                container.appendChild(questionDiv);
                container.appendChild(resultDiv);
                container.appendChild(button);
                parent.appendChild(container);
                return { container, questionDiv, resultDiv, button };
            },

            renderHistory: (parent) => {
                const historyDiv = UI.createElement('div');
                const title = UI.createElement('h3', {}, APP_DATA.history.title);
                historyDiv.appendChild(title);
                APP_DATA.history.paragraphs.forEach(pText => {
                    const p = UI.createElement('p', {}, pText);
                    historyDiv.appendChild(p);
                });
                parent.appendChild(historyDiv);
            },

            renderBlog: (parent) => {
                const blogContainer = UI.createElement('div');
                APP_DATA.blogPosts.forEach(post => {
                    const postDiv = UI.createElement('div', { class: 'blog-post' });
                    const title = UI.createElement('h3', {}, post.title);
                    const meta = UI.createElement('p', { class: 'meta' }, `PubliÃ© le ${post.date}`);
                    const content = UI.createElement('p', {}, post.content);
                    postDiv.appendChild(title);
                    postDiv.appendChild(meta);
                    postDiv.appendChild(content);
                    blogContainer.appendChild(postDiv);
                });
                parent.appendChild(blogContainer);
            },

            renderMemories: (parent) => {
                const memoriesContainer = UI.createElement('div');
                APP_DATA.memories.forEach(memory => {
                    const memoryDiv = UI.createElement('div', { class: 'memory-item' });
                    const eventTitle = UI.createElement('h3', {}, memory.event);
                    const date = UI.createElement('p', { class: 'meta' }, `Date : ${memory.date}`);
                    const description = UI.createElement('p', {}, memory.description);
                    memoryDiv.appendChild(eventTitle);
                    memoryDiv.appendChild(date);
                    memoryDiv.appendChild(description);
                    memoriesContainer.appendChild(memoryDiv);
                });
                parent.appendChild(memoriesContainer);
            },

            showNotification: (message, type = 'info') => {
                const container = document.getElementById('notification-container');
                const notification = UI.createElement('div', { class: `notification ${type}` }, message);
                container.appendChild(notification);
                
                setTimeout(() => notification.classList.add('show'), 100);
                setTimeout(() => {
                    notification.classList.remove('show');
                    setTimeout(() => container.removeChild(notification), 500);
                }, 3000);
            },

            animateCards: () => {
                const cards = document.querySelectorAll('.card');
                cards.forEach((card, index) => {
                    card.style.animationDelay = `${0.2 + index * 0.1}s`;
                    card.style.animationName = 'fadeInCard';
                });
            }
        };

        /**
         * Couche 3 : LA LOGIQUE DE L'APPLICATION
         * GÃ¨re les Ã©vÃ©nements, l'Ã©tat et l'initialisation de la page.
         */
        const App = {
            state: {
                theme: localStorage.getItem('theme') || 'light',
                userName: localStorage.getItem('userName') || null,
                quiz: { active: false, score: 0 }
            },
            elements: {
                themeToggle: document.getElementById('theme-toggle'),
                welcomeMessage: document.getElementById('welcome-message'),
                appContainer: document.getElementById('app-container'),
            },

            init: () => {
                App.renderAllSections();
                App.setupEventListeners();
                App.applyInitialTheme();
                App.animateWelcomeMessage();
            },

            renderAllSections: () => {
                const appContainer = App.elements.appContainer;
                appContainer.appendChild(UI.createCard('gallery', 'Nos moments prÃ©fÃ©rÃ©s', 'Cliquez sur les photos pour les agrandir et les explorer.', UI.renderGallery));
                appContainer.appendChild(UI.createCard('recipes', 'Les recettes de maman', 'DÃ©couvrez notre collection de recettes qui rÃ©chauffent le cÅ“ur.', UI.renderRecipes));
                appContainer.appendChild(UI.createCard('contact', 'Laissez-nous un message', 'Nous adorons recevoir de vos nouvelles !', UI.renderContactForm));
                appContainer.appendChild(UI.createCard('quiz', 'Petit quiz familial', 'Testez vos connaissances sur la famille !', UI.renderQuiz));
                appContainer.appendChild(UI.createCard('history', 'L\'histoire de notre famille', 'De nos origines Ã  nos traditions les plus chÃ¨res, explorez notre histoire.', UI.renderHistory));
                appContainer.appendChild(UI.createCard('blog', 'Blog familial', 'Les derniÃ¨res nouvelles et anecdotes de la famille.', UI.renderBlog));
                appContainer.appendChild(UI.createCard('memories', 'Album de souvenirs', 'Les moments qui ont marquÃ© notre histoire.', UI.renderMemories));
            },

            setupEventListeners: () => {
                App.elements.themeToggle.addEventListener('click', App.toggleTheme);
                const galleryElement = document.getElementById('gallery-card').querySelector('.image-gallery');
                galleryElement.addEventListener('click', App.handleImageClick);
                const contactForm = document.getElementById('contact-card').querySelector('.contact-form');
                contactForm.addEventListener('submit', App.handleContactSubmit);
                const quizContainer = document.getElementById('quiz-card').querySelector('.quiz-container');
                const quizButton = quizContainer.querySelector('#quiz-button');
                quizButton.addEventListener('click', () => App.toggleQuiz(quizContainer));
            },

            applyInitialTheme: () => {
                if (App.state.theme === 'dark') {
                    document.body.classList.add('dark-mode');
                    App.elements.themeToggle.textContent = 'â˜€ï¸';
                }
            },
            toggleTheme: () => {
                document.body.classList.toggle('dark-mode');
                const isDarkMode = document.body.classList.contains('dark-mode');
                App.state.theme = isDarkMode ? 'dark' : 'light';
                localStorage.setItem('theme', App.state.theme);
                App.elements.themeToggle.textContent = isDarkMode ? 'â˜€ï¸' : 'ðŸŒ™';
            },
            animateWelcomeMessage: async () => {
                const message = App.state.userName ? `Bienvenue, ${App.state.userName} !` : 'Bienvenue !';
                App.elements.welcomeMessage.style.opacity = 1;
                for (const char of message) {
                    App.elements.welcomeMessage.textContent += char;
                    await new Promise(resolve => setTimeout(resolve, 50));
                }
                setTimeout(() => App.askForName(), 1500);
            },
            askForName: () => {
                if (!App.state.userName) {
                    const newName = prompt('Nous aimons connaÃ®tre nos visiteurs ! Quel est votre prÃ©nom ?');
                    if (newName && newName.trim() !== '') {
                        App.state.userName = newName.trim();
                        localStorage.setItem('userName', App.state.userName);
                        App.elements.welcomeMessage.textContent = '';
                        App.animateWelcomeMessage();
                        UI.showNotification(`Heureux de vous rencontrer, ${App.state.userName} !`, 'success');
                    }
                }
                UI.animateCards();
            },
            handleImageClick: (event) => {
                if (event.target.tagName === 'IMG') {
                    const modal = UI.createElement('div', { class: 'modal' });
                    const modalImg = UI.createElement('img', { class: 'modal-content', src: event.target.src, alt: event.target.alt });
                    modal.appendChild(modalImg);
                    document.body.appendChild(modal);

                    setTimeout(() => modal.classList.add('open'), 50);
                    modal.addEventListener('click', () => {
                        modal.classList.remove('open');
                        setTimeout(() => document.body.removeChild(modal), 400);
                    });
                }
            },
            handleContactSubmit: (event) => {
                event.preventDefault();
                UI.showNotification('Merci pour votre message !', 'success');
                event.target.reset();
            },
            toggleQuiz: (quizContainer) => {
                const quizQuestionsDiv = quizContainer.querySelector('#quiz-questions');
                const quizResultDiv = quizContainer.querySelector('#quiz-result');
                const quizButton = quizContainer.querySelector('#quiz-button');
                
                if (App.state.quiz.active) {
                    quizQuestionsDiv.innerHTML = '';
                    quizResultDiv.textContent = '';
                    App.state.quiz.active = false;
                    quizButton.textContent = "Lancer le quiz !";
                } else {
                    App.state.quiz.active = true;
                    App.state.quiz.score = 0;
                    quizResultDiv.textContent = '';
                    UI.showNotification('Le quiz commence ! Bonne chance !');
                    APP_DATA.quizQuestions.forEach((q, index) => {
                        const questionItem = UI.createElement('div', { class: 'question-item' });
                        questionItem.innerHTML = `<h3>${index + 1}. ${q.question}</h3>`;
                        q.options.forEach(option => {
                            const optionElement = UI.createElement('div', { class: 'option' }, option);
                            optionElement.addEventListener('click', () => App.checkQuizAnswer(option, q.answer, optionElement, quizResultDiv));
                            questionItem.appendChild(optionElement);
                        });
                        quizQuestionsDiv.appendChild(questionItem);
                    });
                    quizButton.textContent = "Recommencer le quiz";
                }
            },
            checkQuizAnswer: (selectedOption, correctAnswer, element, quizResultDiv) => {
                if (!App.state.quiz.active) return;
                const questionItem = element.parentElement;
                questionItem.querySelectorAll('.option').forEach(opt => {
                    opt.style.pointerEvents = 'none';
                    if (opt.textContent === correctAnswer) {
                        opt.classList.add('correct');
                    }
                });
                if (selectedOption === correctAnswer) {
                    App.state.quiz.score++;
                    element.classList.add('correct');
                    UI.showNotification('Bonne rÃ©ponse ! ðŸŽ‰', 'success');
                } else {
                    element.classList.add('wrong');
                    UI.showNotification('Mauvaise rÃ©ponse...', 'error');
                }
                const allAnswered = Array.from(document.querySelectorAll('.quiz-container .question-item')).every(item => item.querySelector('.correct, .wrong'));
                if (allAnswered) {
                    App.displayFinalQuizResult(quizResultDiv);
                }
            },
            displayFinalQuizResult: (quizResultDiv) => {
                const scorePercentage = (App.state.quiz.score / APP_DATA.quizQuestions.length) * 100;
                let message = `Votre score : ${App.state.quiz.score} / ${APP_DATA.quizQuestions.length}. `;
                if (scorePercentage >= 80) {
                    message += "Fantastique, vous Ãªtes un vrai membre de la famille ! ðŸ’–";
                    quizResultDiv.classList.add('correct');
                } else {
                    message += "Oups, il y a encore beaucoup de choses Ã  apprendre ! ðŸ˜‰";
                    quizResultDiv.classList.add('wrong');
                }
                quizResultDiv.textContent = message;
                App.state.quiz.active = false;
            }
        };

        // Lancement de l'application
        document.addEventListener('DOMContentLoaded', App.init);
    </script>
</body>
</html>
